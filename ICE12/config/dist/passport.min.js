"use strict";var bcrypt=require("bcrypt"),passport=require("passport"),LocalStrategy=require("passport-local").Strategy,connection=require("./database"),User=connection.User,saltRounds=12;passport.serializeUser(function(e,s){s(null,e.id)}),passport.deserializeUser(function(e,s){User.findById(e).then(function(e){s(null,e)}).catch(function(e){s(e,null)})}),passport.use(new LocalStrategy({usernameField:"username"},function(r,t,a){User.findOne({username:r}).then(function(n){if(n)bcrypt.compare(t,n.hashPassword,function(e,s){return e&&a(e,null),s?a(null,n):a(null,!1,{message:"Password was incorrect."})});else{var e=new User({username:r,password:t}),s=bcrypt.hashSync(e.password,saltRounds);s&&(e.password=s,e.save().then(function(e){return a(null,e)}).catch(function(e){return a(null,!1,{message:e})}))}}).catch(function(e){return a(null,!1,{message:e})})})),module.exports=passport;
//# sourceMappingURL=passport.min.js.map
